head
	title #{doc_title} #{site_title} #{site_description} 	
	meta(charset="utf-8")
	meta(http-equiv="X-UA-Compatible", content="IE=edge,chrome=1")
	meta(name='viewport', content='width=device-width, initial-scale=1.0')
	base(href='/')
	meta(name="description", content="#{doc_excerpt}")
	meta(property="fb:app_id" , content="#{fbapp_id}")
	
	// https://developers.facebook.com/docs/reference/opengraph/object-type
	// https://developers.facebook.com/tools/object-browser?app_id=248664598505342
	meta(property="og:type", content="article")
	meta(property="og:title", content="#{doc_title}")
	meta(property="og:image", content="#{doc_thumbnail}")
	meta(property="og:description", content="#{doc_excerpt}")
	meta(property="og:site_name", content="#{site_title}")
	meta(property="og:url", content="#{doc_slug_discret}")

	link(rel='icon', type='image/png', href='favicon.png')
		
	script(type='text/javascript').

		var musicBox
		var SOCKET_URL = '#{socket_url}'
		var SOCKET_SERVER_PORT = '#{socket_server_port}'
		var PORT = '#{port}'
		var root_url = '#{root_url}'
		var api_url = '#{api_url}'
		var doc_include_js = '#{doc_include_js}'
		
		var USERIN = new Object({'username':'#{user_in.username}', 'image_url': '#{user_in.image_url}', '_id': '#{user_in._id}'} )

	// room view ? 
	if(room)
		script(type='text/javascript').
			
			var ROOM = new Object(
				{'name':'#{room.name}',
				'room_branding':'#{room.options_.branding_image_url.value}'
				})



	// bower:css
	link(rel='stylesheet', href='/bower_components/font-awesome/css/font-awesome.css')
	// endbower 

	// build:js bower_components/mbmin.js 
	// bower:js
	script(src='/bower_components/angular/angular.js')
	script(src='/bower_components/angular-resource/angular-resource.js')
	script(src='/bower_components/angular-route/angular-route.js')
	script(src='/bower_components/angular-sanitize/angular-sanitize.js')
	script(src='/bower_components/underscore/underscore.js')
	script(src='/bower_components/momentjs/moment.js')
	script(src='/bower_components/angular-bootstrap/ui-bootstrap-tpls.js')
	// endbower 
	// endbuild  

	// script(type='text/javascript',  src='js/lib/serialize.min.js')

	
	//i18n dynamic load except grunt
	if (env !== 'grunt' )	
	script(type='text/javascript',  src='#{lang_js_url}')

	if (env == 'dev' )	
		script(type='text/javascript',  src='#{root_url}:35729/livereload.js')

		
		// sub if (hard version of file minified or kept locally)
		script(type='text/javascript', src='js/MusicBox/filters.js')
		script(type='text/javascript', src='js/MusicBox/directives.js')

		// Misc libs/utils
		// script(type='text/javascript', src='bower_components/jquery/dist/jquery.min.js')
		// script(type='text/javascript', src='bower_components/underscore/underscore-min.js')
		

		
		link(href="css/min/bootstrap.min.css",rel="stylesheet")

		

		// font loader kept local
		script(type='text/javascript', src='js/lib/webfont.js')

		// calendar functions lib. (momentjs)
		script(type='text/javascript', src='bower_components/momentjs/min/moment-with-langs.min.js')
		script(type='text/javascript', src='bower_components/momentjs/lang/fr.js')

		
		script(type='text/javascript', src='js/MusicBox/services.js')
		script(type='text/javascript', src='js/MusicBox/renderServices.js')

		script(type='text/javascript', src='js/MusicBox/MusicBoxLoop.js')

		
		link(rel='stylesheet', href='css/min/main.css')

		// Angular controllers

		script(type='text/javascript', src='js/MusicBox/markup/markupCtrl.js')
		// script(type='text/javascript', src='js/MusicBox/markup/markupServices.js')

		script(type='text/javascript', src='js/MusicBox/markup/markupRest.js')

		script(type='text/javascript', src='js/MusicBox/section/sectionCtrl.js')


		// document level
		script(type='text/javascript', src='js/MusicBox/document/documentServices.js')
		script(type='text/javascript', src='js/MusicBox/document/documentRest.js')
		script(type='text/javascript', src='js/MusicBox/document/documentCtrl.js')

		// user 
		script(type='text/javascript', src='js/MusicBox/user/userServices.js')
		script(type='text/javascript', src='js/MusicBox/user/userRest.js')		
		script(type='text/javascript', src='js/MusicBox/user/userCtrl.js')

		// Angular top level 'app' routing 
		script(type='text/javascript', src='js/app.js')

		if(socket_url !== '')
			script(src='#{socket_url}:#{socket_server_port}/socket.io/socket.io.js')
	

	
	if (env == 'grunt')
	if (env == 'prod')
		link(rel='stylesheet', href='css/min/main.css')
		// Calling 9 js files, minified crash for angular, whereas .debug no, why ?
		// script(type='text/javascript', src='js/min/MusicBox.min.js')
		script(type='text/javascript',  src='js/min/MusicBox.min-debug.js')

	if (doc_include_js)
		// script(type='text/javascript', src='js/custom_doc/jquery-1.11.1.min.js')
		// script(type='text/javascript', src='js/custom_doc/skrollr.min.js')
		// script(type='text/javascript', src='#{doc_include_js}')

	if (doc_include_css)
		link(rel='stylesheet', href='#{doc_include_css}')

	//
		♪     ♪
			♪     ♪
		Boite à musique
			~MusicBox v.02 Niagara
			Tom Wersinger